<!DOCTYPE html>
<html lang="en">
<head>
<title>Stephen Bolt</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<link href="../css/styles.css" rel="stylesheet" type="text/css" media="all">
<link href="http://fonts.googleapis.com/css?family=Ubuntu:regular,bold" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Vollkorn:regular,italic,bold" rel="stylesheet" type="text/css">
<!--[if lt IE 9]>
<script src="js/html5.js"></script>
<script src="js/IE9.js"></script>
<![endif]-->
</head>
<body>
<div id="headerwrap">
  <header id="mainheader" class="bodywidth clear"> <img src="../images/steve_bw_60x60.jpg" alt="photo" class="logo">
    <hgroup id="websitetitle">
      <h1 style="padding-top:6px;"><span class="bold">Stephen Bolt</span></h1>
      <h2 style="padding-top:2px;">My Code</h2>
    </hgroup>
    <nav>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="#">Skills</a></li>
        <li><a href="../experience/experience_main.html">My Experience</a></li>
        <li><a href="#">Articles</a></li>
        <li><a href="#">About</a></li>
      </ul>
    </nav>
  </header>
</div>

<div id="maincontent" class="bodywidth clear">
  <div id="aboutleft">

    <h3>Introduction</h3>
    <p>
       Across more than the last 10 years I have been building a codebase for the purpose of rapid application development.  My focus has been on the parts of applications
       that are often thought of last.  It is very natural and necessary to focus on the primary/core functions when developing new applications. But most all applications have need
       of a number of 'secondary/supporting functions' such as configuration, logging, encryption, serialization, date processing, interfaces to web services, databases, messaging, 
       email and SMS notifications, modularity, task processing, file processing, etc. Normally these various needs are built in an ad-hock fashion as a necessary but secondary focus 
       of the development process. This results in a wide diversity of techniques in solving the the same set problems.
    </p>
    <p>
       Eventually I when I would start a new job, I would ask whether any libraries were available for handling these very common application support needs. But with only one notable 
       exception I never found what I was looking for and ended up needing to create some of these functions from scratch. I decided that I would  
    </p>

<p/>


    <h3>Awesome Title</h3>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse quis molestie sapien. Proin elit quam, commodo ut aliquet vel, elementum ut odio. Praesent semper tincidunt magna, sed sagittis elit congue sed. Mauris malesuada, elit ut luctus tristique, lectus libero rutrum mauris, ac tristique justo ligula sit amet metus.</p>
    <p>Etiam a magna vitae diam elementum dignissim. Donec eget justo ut eros fermentum sodales. Donec eleifend sodales gravida. Nulla nulla metus, laoreet at consectetur sed, dapibus vitae felis. Donec venenatis laoreet purus vel hendrerit. Donec sit amet sem a metus bibendum gravida sit amet at ligula. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
    <h4>Another Awesome Title</h4>
    <p>Maecenas eu purus ipsum, non accumsan metus. Mauris augue dui, condimentum quis aliquam non, tincidunt id tortor. Donec dignissim sem sed nisl luctus scelerisque. Cras lacinia aliquam orci ac ultricies. Vestibulum ac lacus eu nisi commodo sollicitudin. Curabitur at consectetur leo. Donec augue velit, ornare in fermentum quis, tristique id augue.</p>
    <p>Cras sem est, luctus ac pharetra id, feugiat id enim. Nullam at massa felis, vitae hendrerit tellus. Sed placerat arcu sed risus commodo iaculis. Aenean at felis enim. Mauris eget est in diam sagittis ultrices sit amet eu mi. Sed ultrices, orci et tincidunt fringilla, diam diam consequat elit, vel tempus mauris mi vitae sem. Ut lectus est, commodo a pulvinar at, faucibus et ligula.</p>
  </div>



  <section id="articlesright">
    <article>
      <figure> <img src="images/articleimage.jpg" alt=""> </figure>
      <header><a href="https://github.com/smbolt/smbolt_git/tree/master/code/CS/Libs" target="_blank">
        <h5>Reusable C# Libraries</h5>
        </a></header>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse quis molestie sapien. Proin elit quam dolor amet...</p>
      <a href="#" class="readmore">Read more</a> </article>
    <article>
      <figure> <img src="images/articleimage.jpg" alt=""> </figure>
      <header><a href="#">
        <h5>Random News Article</h5>
        </a></header>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse quis molestie sapien. Proin elit quam dolor amet...</p>
      <a href="#" class="readmore">Read more</a> </article>
    <article>
      <figure> <img src="images/articleimage.jpg" alt=""> </figure>
      <header><a href="#">
        <h5>Random News Article</h5>
        </a></header>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse quis molestie sapien. Proin elit quam dolor amet...</p>
      <a href="#" class="readmore">Read more</a> </article>
  </section>
</div>
<div id="footerwrap">
  <footer id="mainfooter" class="bodywidth clear">
    <nav class="clear">
      <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">News</a></li>
        <li><a href="#">Resources</a></li>
        <li><a href="#">Sitemap</a></li>
        <li><a href="#">Contact Us</a></li>
      </ul>
    </nav>
  </footer>
</div>

<div>

<!-- code formatted by http://manoli.net/csharpformat/ -->
<pre class="csharpcode">
<span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Text;
<span class="kwrd">using</span> System.Threading.Tasks;
<span class="kwrd">using</span> Org.GS.Configuration;

<span class="kwrd">namespace</span> Org.GS
{
  <span class="kwrd">public</span> <span class="kwrd">enum</span> TaskRequestType
  {
    ScheduledTask,
    OtherJob,
    OnDemand
  }

  <span class="kwrd">public</span> <span class="kwrd">class</span> TaskRequest
  {
    <span class="kwrd">public</span> <span class="kwrd">string</span> TaskName { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">string</span> ProcessorName { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">string</span> ProcessorVersion { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">string</span> ProcessorNameAndVersion { <span class="kwrd">get</span> { <span class="kwrd">return</span> <span class="kwrd">this</span>.ProcessorName + <span class="str">"_"</span> + <span class="kwrd">this</span>.ProcessorVersion; } }
    <span class="kwrd">public</span> TaskRequestType TaskRequestType { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">bool</span> TrackHistory { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">int</span>? RunId { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">int</span> ScheduledTaskId { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">int</span> ProcessorTypeId { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> ParmSet ParmSet { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> DateTime ScheduledRunDateTime { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> DateTime TimeDispatched { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> DateTime TimeCompleted { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">string</span> TaskRequestId { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">bool</span> RunUntilTask { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">int</span>? RunUntilPeriodContextId { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">int</span>? RunUntilOffsetMinutes { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">bool</span> SuppressNotificationsOnSuccess { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">bool</span> AllowConcurrent { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">bool</span> IsDryRun { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> <span class="kwrd">object</span> Object { <span class="kwrd">get</span>; <span class="kwrd">set</span>; }
    <span class="kwrd">public</span> TimeSpan RemainingTimeTilSchedule { <span class="kwrd">get</span> { <span class="kwrd">return</span> Get_RemainingTimeTilSchedule(); } }
    <span class="kwrd">public</span> <span class="kwrd">string</span> RemainingTimeTilScheduleFmt { <span class="kwrd">get</span> { <span class="kwrd">return</span> Get_RemainingTimeTilScheduleFmt(); } }

    <span class="kwrd">public</span> TaskRequest(<span class="kwrd">int</span> scheduledTaskId, <span class="kwrd">string</span> taskName, <span class="kwrd">string</span> processorName, <span class="kwrd">string</span> processorVersion, <span class="kwrd">int</span> processorTypeId, 
                      TaskRequestType taskRequestType, ParmSet parmSet, DateTime scheduledRunDateTime, <span class="kwrd">bool</span> trackHistory, <span class="kwrd">bool</span> runUntilTask, 
                      <span class="kwrd">int</span>? runUntilPeriodContextId, <span class="kwrd">int</span>? runUntilOffsetMinutes, <span class="kwrd">bool</span> suppressNotificationsOnSuccess)
    {
      <span class="kwrd">this</span>.ScheduledTaskId = scheduledTaskId;
      <span class="kwrd">this</span>.TaskName = taskName;
      <span class="kwrd">this</span>.ProcessorName = processorName;
      <span class="kwrd">this</span>.ProcessorVersion = processorVersion;
      <span class="kwrd">this</span>.ProcessorTypeId = processorTypeId;
      <span class="kwrd">this</span>.TaskRequestType = taskRequestType;
      <span class="kwrd">this</span>.TrackHistory = trackHistory;
      <span class="kwrd">this</span>.RunId = <span class="kwrd">null</span>;
      <span class="kwrd">this</span>.ParmSet = parmSet;
      <span class="kwrd">this</span>.ScheduledRunDateTime = scheduledRunDateTime;
      <span class="kwrd">this</span>.TimeDispatched = DateTime.MinValue;
      <span class="kwrd">this</span>.TimeCompleted = DateTime.MinValue;
      <span class="kwrd">this</span>.TaskRequestId = String.Empty;
      <span class="kwrd">this</span>.RunUntilTask = runUntilTask;
      <span class="kwrd">this</span>.RunUntilPeriodContextId = runUntilPeriodContextId;
      <span class="kwrd">this</span>.RunUntilOffsetMinutes = runUntilOffsetMinutes;
      <span class="kwrd">this</span>.SuppressNotificationsOnSuccess = suppressNotificationsOnSuccess;
      <span class="kwrd">this</span>.AllowConcurrent = <span class="kwrd">false</span>;
      <span class="kwrd">this</span>.IsDryRun = GetIsDryRun();
      <span class="kwrd">this</span>.Object = <span class="kwrd">null</span>;
    }

    <span class="kwrd">private</span> <span class="kwrd">bool</span> GetIsDryRun()
    {
      <span class="kwrd">bool</span> isDryRun = <span class="kwrd">false</span>;

      <span class="kwrd">foreach</span> (<span class="kwrd">var</span> parm <span class="kwrd">in</span> <span class="kwrd">this</span>.ParmSet)
      {
        <span class="kwrd">if</span> (parm.ParameterName == <span class="str">"IsDryRun"</span>)
        {
          isDryRun = parm.ParameterValue.ToString().ToBoolean();
          <span class="kwrd">break</span>;
        }
      }
      <span class="kwrd">return</span> isDryRun;
    }

    <span class="kwrd">private</span> TimeSpan Get_RemainingTimeTilSchedule()
    {
      <span class="kwrd">if</span> (<span class="kwrd">this</span>.ScheduledRunDateTime &lt; DateTime.Now)
        <span class="kwrd">return</span> <span class="kwrd">new</span> TimeSpan(0); 

      <span class="kwrd">return</span> <span class="kwrd">this</span>.ScheduledRunDateTime - DateTime.Now;
    }

    <span class="kwrd">private</span> <span class="kwrd">string</span> Get_RemainingTimeTilScheduleFmt()
    {
      <span class="kwrd">if</span> (<span class="kwrd">this</span>.ScheduledRunDateTime &lt; DateTime.Now)
        <span class="kwrd">return</span> <span class="str">"0 seconds"</span>;

      TimeSpan ts = <span class="kwrd">this</span>.ScheduledRunDateTime - DateTime.Now;
      <span class="kwrd">return</span> ts.TotalSeconds.ToString(<span class="str">"####.000"</span>) + <span class="str">" seconds."</span>;
    }

    <span class="kwrd">public</span> <span class="kwrd">string</span> GetParmReport()
    {
      StringBuilder sb = <span class="kwrd">new</span> StringBuilder();

      sb.Append(<span class="str">"TASK PARAMETERS REPORT"</span> + g.crlf2 +
                <span class="str">"Task: "</span> + <span class="kwrd">this</span>.TaskName + <span class="str">" at "</span> + <span class="kwrd">this</span>.ScheduledRunDateTime + g.crlf2 +
                <span class="str">"Parameter Name"</span>.PadTo(40) + <span class="str">"Data Type"</span>.PadTo(50) + <span class="str">"Parameter Value"</span> + g.crlf +
                <span class="str">"--------------------------------------------------------------------------------------------------------------------------------------"</span> + g.crlf);

      <span class="kwrd">foreach</span> (<span class="kwrd">var</span> parm <span class="kwrd">in</span> <span class="kwrd">this</span>.ParmSet)
      {
        sb.Append(parm.ParameterName.PadTo(40) + parm.ParameterType.ToString().PadTo(50));

        <span class="kwrd">switch</span> (parm.ParameterType.Name)
        {
          <span class="kwrd">case</span> <span class="str">"String"</span>:
          <span class="kwrd">case</span> <span class="str">"Int32"</span>:
            sb.Append(parm.ParameterValue);
            <span class="kwrd">break</span>;

          <span class="kwrd">case</span> <span class="str">"ConfigDbSpec"</span>:
            <span class="kwrd">var</span> configDbSpec = parm.ParameterValue <span class="kwrd">as</span> ConfigDbSpec;
            sb.Append(configDbSpec.ConnectionString);
            <span class="kwrd">break</span>;

          <span class="kwrd">case</span> <span class="str">"ConfigWsSpec"</span>:
            <span class="kwrd">var</span> configWsSpec = parm.ParameterValue <span class="kwrd">as</span> ConfigWsSpec;
            sb.Append(configWsSpec.WebServiceEndpoint);
            <span class="kwrd">break</span>;

          <span class="kwrd">case</span> <span class="str">"Dictionary`2"</span>:
            <span class="kwrd">var</span> dict = parm.ParameterValue <span class="kwrd">as</span> Dictionary&lt;<span class="kwrd">string</span>, <span class="kwrd">string</span>&gt;;
            sb.Remove(sb.Length - 50, 50);
            sb.Append(<span class="str">"Dictionary&lt;string, string&gt;"</span>);
            <span class="kwrd">foreach</span> (<span class="kwrd">var</span> kvp <span class="kwrd">in</span> dict)
            {
              sb.Append(g.crlf + String.Empty.PadTo(2) + kvp.Key.PadTo(40) + <span class="str">"  "</span> + kvp.Value);
            }
            <span class="kwrd">break</span>;

          <span class="kwrd">default</span>:
            sb.Append(<span class="str">"[Type:"</span> + parm.ParameterType.Name + <span class="str">"] "</span> + parm.ParameterValue.ToString());
            <span class="kwrd">break</span>;
        }
        sb.Append(g.crlf);
      }

      <span class="kwrd">return</span> sb.ToString();
    }
  }
}
</pre>

</div>

</body>
</html>
